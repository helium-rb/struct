#!/usr/bin/env ruby

require "bundler/setup"
require 'byebug'
require "helium/console"
require "helium/struct"
require "helium/struct/hooks"
require "helium/struct/use"

class NameStruct
  include Helium::Struct
  include Helium::Struct::Hooks

  attribute :full_name
  attribute :full_name_caps

  on_change(:full_name) do |value|
    self.full_name_caps = value&.upcase
  end
end

class UserStruct
  include Helium::Struct
  include Helium::Struct::Undefined
  include Helium::Struct::Hooks
  include Helium::Struct::Use


  attribute :email
  use NameStruct, as: :name_struct, map: { full_name_caps: :name_caps, full_name: :name }, prefix: :user
end

Pry.start
